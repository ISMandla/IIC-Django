{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>IIC</title>
    <link rel="icon" sizes="128*128" href="{{iic.navLogo.url}}" />
    <meta
      name="description"
      content="Navbar with provided logo (outer background removed)"
    />

    <style>
      /* --- Basic tokens & resets --- */
      :root{
        --bg: #ffffff;
        --accent: #2563eb;
        --accent-2: #06b6d4;
        --muted: #64748b;
        --text: #0f1724;
        --radius: 12px;
        --nav-height: 76px; /* slightly taller for better balance */
      }
      *{box-sizing:border-box}
      html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;color:var(--text);-webkit-font-smoothing:antialiased;background:var(--bg)}
      a{color:inherit;text-decoration:none}

      /* --- NAV WRAP --- */
      .nav-wrap{
        position:fixed;
        left:0;right:0;top:0;
        z-index:1000;
        transition: background 240ms ease, box-shadow 240ms ease, transform 240ms ease;
        will-change:background,box-shadow;
        {% comment %} padding-bottom:1px; {% endcomment %}
        backdrop-filter: blur(4px);
      }

      .nav{
        max-width:1400px;
        margin:0 auto;
        padding:0 24px;
        height:var(--nav-height);
        display:flex;
        align-items:center;
        justify-content:space-between;
      }

      /* BRAND */
      .brand{display:flex;align-items:center;gap:14px}
      .brand a{display:inline-flex;align-items:center;gap:12px}
      .logo-mark{
        width:120px;
        height:120px;
        border-radius:10px;
        overflow:hidden;
        display:flex;
        align-items:center;
        justify-content:center;
        background:transparent;
        box-shadow:none;
        border:0;
        transition: transform 200ms ease;
      }
      .logo-mark img{display:block;width:100%;height:100%;object-fit:contain;background:transparent}

      /* right area */
      .right-area{display:flex;align-items:center;gap:12px;width:auto}

      /* desktop menu */
      .menu{display:flex;gap:8px;align-items:center}
      .menu-item{position:relative}

      .menu-link{
        display:inline-block;
        padding:8px 14px;
        border-radius:10px;
        font-weight:600;
        color:var(--muted);
        transition: color 160ms ease, transform 160ms ease, background 160ms ease;
        position:relative;
      }

      /* subtle underline for active */
      .menu-link.active::after{
        content:'';
        position:absolute;
        left:10%;
        right:10%;
        bottom:6px;
        height:3px;
        border-radius:3px;
        background:linear-gradient(90deg,var(--accent),var(--accent-2));
        transform-origin:center;
      }

      .menu-link:hover{
        color:var(--text);
        background: rgba(15,23,36,0.03);
        transform: translateY(-2px);
      }

      /* enable pointer for div.menu-link (non-clickable parent items) */
      .menu-item > .menu-link{cursor:pointer}
      .menu-item > .menu-link:hover{color:var(--text);background:rgba(15,23,36,0.03);transform:translateY(-2px)}

      /* dropdown */
      .dropdown{
        position: absolute;
        left: 0;
        top: 100%;
        margin-top: 1px;
        min-width: 220px;
        background: #fff;
        border: 1px solid rgba(15, 23, 36, 0.06);
        border-radius: 12px;
        box-shadow: 0 18px 50px rgba(2, 6, 23, 0.08);
        padding: 8px;
        display: none;
        transform-origin: top center;
      }
      .dropdown.show{display:block;animation:dropdown-in 180ms ease}
      @keyframes dropdown-in{
        from{opacity:0;transform:translateY(-6px) scale(0.985)}
        to{opacity:1;transform:translateY(0) scale(1)}
      }
      .dropdown a{display:block;padding:10px 12px;border-radius:8px;color:var(--muted);font-weight:600}
      .dropdown a:hover{background:rgba(15,23,36,0.03);color:var(--text)}

      /* auth buttons */
      .auth{display:flex;gap:8px;align-items:center;margin-left:6px}
      .btn{padding:10px 14px;border-radius:10px;font-weight:700;cursor:pointer;border:0;display:inline-flex;align-items:center;justify-content:center;gap:8px}
      .btn.ghost{background:transparent;border:1px solid rgba(15,23,36,0.06);color:var(--text);transition:background 160ms ease, transform 120ms ease}
      .btn.ghost:hover{background:rgba(15,23,36,0.03);transform:translateY(-2px)}
      .btn.primary{
        background:linear-gradient(90deg,var(--accent),var(--accent-2));
        color:#fff;
        box-shadow:0 10px 24px rgba(37,99,235,0.12);
        transition:transform 120ms ease, box-shadow 120ms ease;
      }
      .btn.primary:hover{transform:translateY(-2px);box-shadow:0 16px 34px rgba(37,99,235,0.14)}

      /* mobile toggle */
      .mobile-toggle{display:none;background:transparent;border:0;font-size:20px;cursor:pointer;padding:8px}

      /* mobile panel */
      .mobile-panel{display:none;background:#fff;border-top:1px solid rgba(15,23,36,0.06);box-shadow:0 18px 40px rgba(2,6,23,0.06)}
      .mobile-panel.open{display:block;animation:panel-in 160ms ease}
      @keyframes panel-in{from{opacity:0;transform:translateY(-6px)}to{opacity:1;transform:translateY(0)}}
      .mobile-list{padding:12px 16px;display:flex;flex-direction:column;gap:6px}
      .mobile-list a{padding:12px 12px;border-radius:8px;color:var(--muted);font-weight:600}
      .mobile-list a:hover{background:rgba(15,23,36,0.03);color:var(--text)}
      .mobile-sub{padding-left:14px;margin-top:4px;display:flex;flex-direction:column;gap:4px}

      /* small screens */
      @media (max-width:880px){
        .menu{display:none}
        .auth{display:none}
        .mobile-toggle{display:inline-flex}
        .nav{padding:0 12px}
        .logo-mark{width:58px;height:58px} /* scale slightly down on mobile */
      }

      /* transparent vs scrolled */
      .nav-wrap.transparent{background:linear-gradient(180deg, rgba(255,255,255,0.0) 0%, rgba(255,255,255,0.0) 100%);box-shadow:none;border-bottom:0}
      .nav-wrap.scrolled{background:#fff;border-bottom:1px solid rgba(233,236,240,0.06);box-shadow:0 8px 28px rgba(2,6,23,0.06);transform:translateY(0)}

      /* accessibility */
      .menu-link:focus,.btn:focus,.mobile-list a:focus{outline:3px solid rgba(37,99,235,0.12);outline-offset:2px}
      .brand a:focus{outline:3px solid rgba(2,6,23,0.06);outline-offset:3px;border-radius:8px}

      /* ensure main content is not hidden behind fixed nav */
      main{padding-top:calc(var(--nav-height) + 8px)}
    </style>
  </head>
  <body>
    <!-- NAVBAR -->
    <header class="nav-wrap transparent" id="siteNav">
      <nav class="nav" role="navigation" aria-label="Main navigation">
        <!-- left: only logo -->
        <div class="brand">
          <a href="/" aria-label="Home">
            <span class="logo-mark" aria-hidden="false">
              <img src="{{iic.navLogo.url}}" alt="IIC Logo" />
            </span>
          </a>
        </div>

        <!-- right: menu + auth + mobile toggle -->
        <div class="right-area" style="margin-left: auto; align-items: center">
          <div
            class="menu"
            id="desktopMenu"
            role="menubar"
            aria-label="Primary"
          ></div>

          <div class="auth" id="authButtons" aria-live="polite"></div>

          <button
            class="mobile-toggle"
            id="mobileToggle"
            aria-expanded="false"
            aria-controls="mobilePanel"
            aria-label="Toggle menu"
          >
            <svg
              id="hambIcon"
              width="22"
              height="22"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.8"
            >
              <path d="M3 7h18M3 12h18M3 17h18" />
            </svg>
            <svg
              id="closeIcon"
              width="22"
              height="22"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.8"
              style="display: none"
            >
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>
      </nav>

      <!-- Mobile Panel -->
      <div class="mobile-panel" id="mobilePanel" aria-hidden="true">
        <div class="mobile-list" id="mobileList"></div>
      </div>
    </header>

    <main>
      <div style="max-width: 1200px; margin: 40px auto; padding: 0px"></div>
    </main>

    <!-- KEEP JS LOGIC UNCHANGED -->
    <script>
      /****************************************************************
       * Navbar data
       ****************************************************************/
      const navItems = [
        { name: "Home", path: "{% if request.user.is_superuser %}{% url 'admin-site' %}{% else %}{% url 'home' %}{% endif %}" },
        {
          name: "About",
          submenu: [
            { name: "IIC Team Members", path: "{% url 'team_members' %}" },
            { name: "Certificate", path: "{% url 'certificate' %}" },
          ],
        },
        { name: "R&D Cell", path: "{% url 'research' %}" },
        {
          name: "Activities",
          submenu: [
            { name: "Meeting", path: "{% url 'meet' %}" },
            { name: "Activities", path: "{% url 'activities' %}" },
            { name: "Achievements", path: "{% url 'achievments' %}" },
          ],
        },
        {
          name: "Innovation",
          submenu: [
            { name: "IPR Cell", path: "{% url 'ipr' %}" },
            { name: "Incubators List", path: "{% url 'incubation' %}" },
            {% comment %} { name: "Students Start-ups", path: "/innovation/startups" }, {% endcomment %}
          ],
        },
        {
          name: "Connect",
          submenu: [
            { name: "Gallery", path: "{% url 'gallery' %}" },
            { name: "Notice Board", path: "{% url 'notice' %}" },
            { name: "Contact Us", path: "{% url 'contact' %}" },
          ],
        },
      ];

      /****************************************************************
       * Utilities
       ****************************************************************/
      function isHashLink(path) {
        return path && path.includes("#") && path.split("#").length === 2;
      }

      function isActiveItem(itemPath) {
        try {
          const currentPath = window.location.pathname || "/";
          const currentHash = window.location.hash || "";
          if (isHashLink(itemPath)) {
            const [p, h] = itemPath.split("#");
            const hash = "#" + h;
            return (
              (p === currentPath || (p === "" && currentPath === "/")) &&
              currentHash === hash
            );
          }
          return currentPath.startsWith(itemPath);
        } catch (e) {
          return false;
        }
      }

      /****************************************************************
       * Render desktop menu
       ****************************************************************/
      const desktopMenu = document.getElementById("desktopMenu");

      navItems.forEach((item) => {
        const wrapper = document.createElement("div");
        wrapper.className = "menu-item";
        wrapper.setAttribute("role", "none");

        const isNonClickable =
          item.name === "Innovation" || item.name === "Connect";

        const link = document.createElement(isNonClickable ? "div" : "a");
        link.className = "menu-link";
        link.setAttribute("role", isNonClickable ? "presentation" : "menuitem");
        link.setAttribute("tabindex", "0");
        link.textContent = item.name;
        if (!isNonClickable) link.href = item.path || "#";

        if (isActiveItem(item.path)) link.classList.add("active");

        wrapper.appendChild(link);

        if (item.submenu && item.submenu.length) {
          const dropdown = document.createElement("div");
          dropdown.className = "dropdown";
          dropdown.setAttribute("role", "menu");

          item.submenu.forEach((sub) => {
            const subLink = document.createElement("a");
            subLink.href = sub.path || "#";
            subLink.textContent = sub.name;
            subLink.setAttribute("role", "menuitem");
            dropdown.appendChild(subLink);
          });

          wrapper.appendChild(dropdown);

          wrapper.addEventListener("mouseenter", () => {
            dropdown.classList.add("show");
          });
          wrapper.addEventListener("mouseleave", () => {
            dropdown.classList.remove("show");
          });

          link.addEventListener("focus", () => {
            dropdown.classList.add("show");
          });
          wrapper.addEventListener("focusout", (e) => {
            if (!wrapper.contains(e.relatedTarget))
              dropdown.classList.remove("show");
          });
        }

        desktopMenu.appendChild(wrapper);
      });

      /****************************************************************
       * Auth buttons
       ****************************************************************/
      const authArea = document.getElementById("authButtons");

      function renderAuth() {
        authArea.innerHTML = "";
        const isLoggedIn = !!localStorage.getItem("authToken");

        {% if request.user.is_authenticated %}
          const profile = document.createElement("a");
          profile.href = "{% url 'admin-profile' %}";
          profile.className = "btn ghost";
          profile.textContent = "Profile";
          authArea.appendChild(profile);

          const logout = document.createElement("a");
          logout.href = "{% url 'logout' %}";
          logout.className = "btn primary";
          logout.textContent = "Logout";
          authArea.appendChild(logout);
        {% else %}
          const login = document.createElement("a");
          login.href = "{% url 'login' %}";
          login.className = "btn ghost";
          login.textContent = "Login";
          authArea.appendChild(login);
        {% endif %}

        }

      renderAuth();

      /****************************************************************
       * Mobile panel rendering + open/close
       ****************************************************************/
      const mobileToggle = document.getElementById("mobileToggle");
      const mobilePanel = document.getElementById("mobilePanel");
      const mobileList = document.getElementById("mobileList");
      const hambIcon = document.getElementById("hambIcon");
      const closeIcon = document.getElementById("closeIcon");

      function renderMobileList() {
        mobileList.innerHTML = "";

        navItems.forEach((item) => {
          const isNonClickable =
            item.name === "Innovation" || item.name === "Connect";

          if (isNonClickable) {
            const title = document.createElement("div");
            title.textContent = item.name;
            title.style.fontWeight = 700;
            title.style.padding = "8px 0";
            mobileList.appendChild(title);
          } else {
            const link = document.createElement("a");
            link.href = item.path || "#";
            link.textContent = item.name;
            mobileList.appendChild(link);
          }

          if (item.submenu && item.submenu.length) {
            const subWrap = document.createElement("div");
            subWrap.className = "mobile-sub";
            item.submenu.forEach((sub) => {
              const sLink = document.createElement("a");
              sLink.href = sub.path || "#";
              sLink.textContent = sub.name;
              sLink.style.fontSize = "0.95rem";
              subWrap.appendChild(sLink);
            });
            mobileList.appendChild(subWrap);
          }
        });

        const sep = document.createElement("div");
        sep.style.borderTop = "1px solid rgba(15,23,36,0.06)";
        sep.style.marginTop = "8px";
        sep.style.paddingTop = "10px";
        mobileList.appendChild(sep);

        const mobileAuthWrap = document.createElement("div");
        mobileAuthWrap.style.display = "flex";
        mobileAuthWrap.style.flexDirection = "column";
        mobileAuthWrap.style.gap = "8px";

        const isLoggedIn = !!localStorage.getItem("authToken");
        if (isLoggedIn) {
          const p = document.createElement("a");
          p.href = "/profile";
          p.textContent = "Profile";
          p.style.fontWeight = 700;
          p.style.padding = "8px 0";

          const l = document.createElement("a");
          l.href = "#";
          l.textContent = "Logout";
          l.style.color = "#fff";
          l.style.background =
            "linear-gradient(90deg,var(--accent),var(--accent-2))";
          l.style.padding = "8px";
          l.style.borderRadius = "8px";

          l.addEventListener("click", (e) => {
            e.preventDefault();
            localStorage.removeItem("authToken");
            localStorage.removeItem("currentUser");
            window.location.href = "/";
          });

          mobileAuthWrap.appendChild(p);
          mobileAuthWrap.appendChild(l);
        } else {
          const p1 = document.createElement("a");
          p1.href = "/login";
          p1.textContent = "Login";
          p1.style.fontWeight = 700;
          p1.style.padding = "8px 0";

          const p2 = document.createElement("a");
          p2.href = "/signup";
          p2.textContent = "Sign Up";
          p2.style.fontWeight = 700;
          p2.style.padding = "8px 0";

          mobileAuthWrap.appendChild(p1);
          mobileAuthWrap.appendChild(p2);
        }

        mobileList.appendChild(mobileAuthWrap);
      }
      renderMobileList();

      let mobileOpen = false;

      function setMobileOpen(open) {
        mobileOpen = open;

        if (open) {
          mobilePanel.classList.add("open");
          mobilePanel.setAttribute("aria-hidden", "false");
          mobileToggle.setAttribute("aria-expanded", "true");
          hambIcon.style.display = "none";
          closeIcon.style.display = "inline";
        } else {
          mobilePanel.classList.remove("open");
          mobilePanel.setAttribute("aria-hidden", "true");
          mobileToggle.setAttribute("aria-expanded", "false");
          hambIcon.style.display = "inline";
          closeIcon.style.display = "none";
        }
      }

      mobileToggle.addEventListener("click", () => setMobileOpen(!mobileOpen));

      mobileList.addEventListener("click", (e) => {
        const a = e.target.closest("a");
        if (a) {
          setMobileOpen(false);
        }
      });

      /****************************************************************
       * Scroll listener
       ****************************************************************/
      const siteNav = document.getElementById("siteNav");
      function handleScroll() {
        const y = window.scrollY || document.documentElement.scrollTop;
        if (y > 20) {
          siteNav.classList.remove("transparent");
          siteNav.classList.add("scrolled");
        } else {
          siteNav.classList.remove("scrolled");
          siteNav.classList.add("transparent");
        }
      }
      handleScroll();
      window.addEventListener("scroll", handleScroll);

      /****************************************************************
       * Recompute active link
       ****************************************************************/
      function refreshActive() {
        document
          .querySelectorAll(".menu-link")
          .forEach((el) => el.classList.remove("active"));
        navItems.forEach((item) => {
          const links = Array.from(document.querySelectorAll(".menu-link"));
          links.forEach((link) => {
            if (
              link.textContent.trim() === item.name &&
              isActiveItem(item.path)
            ) {
              link.classList.add("active");
            }
          });
        });
      }
      refreshActive();
      window.addEventListener("hashchange", refreshActive);
      window.addEventListener("popstate", refreshActive);

      /****************************************************************
       * Keyboard: close dropdowns and mobile with Escape
       ****************************************************************/
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") {
          document
            .querySelectorAll(".dropdown.show")
            .forEach((d) => d.classList.remove("show"));
          if (mobileOpen) setMobileOpen(false);
        }
      });
    </script>
  </body>
</html>
