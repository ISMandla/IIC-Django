{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Institution of Innovation Council — R&amp;D Cell</title>
    <meta
      name="description"
      content="IIC R&D Cell — searchable researches and departments"
    />
    <style>
      :root{
        --bg: #f8fafc;
        --card-bg: #ffffff;
        --muted: #6b7280;
        --text: #0f1724;
        --accent-1: #0f1724;
        --accent-grad: linear-gradient(90deg,#3b82f6,#2563eb);
        --glass-blur: 6px;
        --radius: 16px;
        --card-shadow: 0 8px 30px rgba(15, 23, 42, 0.06);
        --nav-offset: 96px;
        --max-width: 1200px;
      }
      * { box-sizing: border-box; }
      html,body { height:100%; margin:0; font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; color:var(--text); background:var(--bg); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
      a { color:inherit; text-decoration:none; }

      .container{ max-width:var(--max-width); margin:0 auto; padding:28px 20px 80px; }

      /* Heading */
      .heading{ text-align:center; margin-bottom:20px; }
      h1{ font-size:clamp(24px,3.6vw,44px); margin:0 0 8px; font-weight:800; letter-spacing:-0.02em; color:var(--accent-1); }
      .heading-underline{ width:88px; height:6px; border-radius:999px; margin:10px auto 0; background:var(--accent-grad); box-shadow: 0 6px 20px rgba(37,99,235,0.12); }

      /* Search */
      .search-area{ max-width:920px; margin:0 auto 28px; }
      .search-row{ display:flex; gap:10px; align-items:center; }
      .search-box{ flex:1; position:relative; }
      .search-box input{
        width:100%;
        padding:14px 16px 14px 46px;
        border-radius:14px;
        border:1px solid #e6e9ef;
        background:var(--card-bg);
        font-size:15px;
        color:#111827;
        box-shadow: 0 6px 18px rgba(2,6,23,0.04);
        transition: box-shadow .15s ease, transform .12s ease;
      }
      .search-box input:focus{
        outline: none;
        box-shadow: 0 8px 28px rgba(37,99,235,0.12);
        transform: translateY(-1px);
        border-color: rgba(37,99,235,0.18);
      }
      .search-box input::placeholder { color:#9ca3af; }
      .search-icon{ position:absolute; left:14px; top:50%; transform:translateY(-50%); width:20px; height:20px; opacity:0.75; display:flex; align-items:center; justify-content:center; color:var(--muted); }

      .btn{
        padding:12px 18px;
        border-radius:12px;
        border:0;
        cursor:pointer;
        font-weight:700;
        background:var(--accent-grad);
        color:white;
        box-shadow: 0 10px 28px rgba(37,99,235,0.14);
        transition: transform .12s ease, box-shadow .12s ease;
      }
      .btn:hover{ transform: translateY(-2px); box-shadow: 0 16px 36px rgba(37,99,235,0.16); }
      .btn:active{ transform: translateY(0); }

      /* Panels */
      .glass-panel{
        background:var(--card-bg);
        border-radius:16px;
        padding:18px;
        border:1px solid rgba(15,23,42,0.04);
        box-shadow: var(--card-shadow);
        margin-bottom:18px;
      }

      /* Grid */
      .grid{ display:grid; gap:16px; grid-template-columns: repeat(1, minmax(0,1fr)); }
      @media (min-width:640px){ .grid{ grid-template-columns: repeat(2, minmax(0,1fr)); } }
      @media (min-width:1024px){ .grid{ grid-template-columns: repeat(4, minmax(0,1fr)); } }

      /* Card */
      .card{
        padding:18px;
        border-radius:16px;
        background:var(--card-bg);
        border:1px solid rgba(15,23,42,0.03);
        cursor:pointer;
        text-align:center;
        transition: transform .18s cubic-bezier(.2,.9,.3,1), box-shadow .18s ease;
        display:flex;
        flex-direction:column;
        align-items:center;
        justify-content:center;
        gap:10px;
        min-height:140px;
      }
      .card:focus-within, .card:focus { box-shadow: 0 10px 30px rgba(2,6,23,0.06); transform: translateY(-6px); outline: none; }
      .card:hover{ transform: translateY(-8px); box-shadow: 0 18px 50px rgba(2,6,23,0.08); }

      /* Icon area: use an <img> so departments can use specific SVGs */
      .card-icon {
        width:72px;
        height:72px;
        border-radius:14px;
        display:flex;
        align-items:center;
        justify-content:center;
        background:linear-gradient(135deg,#eef2ff, #f0f9ff);
        box-shadow: inset 0 1px 0 rgba(255,255,255,0.6);
        flex-shrink:0;
      }
      .card-icon img{ width:44px; height:44px; display:block; object-fit:contain; }

      .name{ font-size:16px; font-weight:700; margin:0; color:var(--accent-1); }
      .dept-title{ font-weight:600; font-size:13px; color:var(--muted); margin-top:4px; }

      /* Utilities */
      .space-between{ display:flex; justify-content:space-between; align-items:center; }
      .row{ display:flex; align-items:center; gap:12px; }

      /* result items */
      .result-item{ padding:12px; border-radius:10px; background:var(--card-bg); border:1px solid rgba(15,23,42,0.03); display:flex; justify-content:space-between; align-items:center; }
      .result-left{ display:flex; gap:12px; align-items:center; }
      .result-photo{ width:44px; height:44px; border-radius:999px; object-fit:cover; }

      .empty{ padding:28px; text-align:center; color:var(--muted); font-size:15px; }

      /* back button */
      .back-btn{ display:inline-flex; align-items:center; gap:8px; padding:8px 10px; border-radius:10px; background:transparent; border:none; color:var(--muted); cursor:pointer; }
      .back-btn:hover{ color:var(--accent-1); }

      /* ensure content doesn't hide under fixed navbar if nav is fixed */
      main, section { padding-top: 12px; }
      /* if nav is fixed, the include nav may need top offset — safe extra spacing already provided by container padding */

      /* small screens tweak */
      @media (max-width:420px){
        .card-icon{ width:56px; height:56px; }
        .card-icon img{ width:36px; height:36px; }
        .card{ min-height:120px; padding:14px; }
      }
    </style>
    <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      integrity="sha512-pap0X...replace-with-current-integrity..."
      crossorigin="anonymous" referrerpolicy="no-referrer" />
  </head>
  <body>
    {% include 'nav.html' %}

    <section id="rd-cell" style="margin-top:8px">
      <div class="container" id="root">
        <div class="heading">
          <h1>R&amp;D Cell</h1>
          <div class="heading-underline" aria-hidden="true"></div>
        </div>

        <!-- Search -->
        <div class="search-area" aria-labelledby="searchLabel">
          <form id="searchForm" class="search-row" method="get" action="{% url 'searchresults' %}" role="search" aria-label="Search researches">
            <div class="search-box">
              <div class="search-icon" aria-hidden="true">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><circle cx="11" cy="11" r="7"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
              </div>

              <input id="searchInput" name="q" type="text"
                    placeholder="Search researches by field, domain, or title..."
                    aria-label="Search researches"
                    value="{{ request.GET.q|default:'' }}" />
            </div>

            <button id="searchBtn" class="btn" aria-label="Search" type="submit">Search</button>
          </form>
        </div>

        <!-- Dynamic Panels -->
        <div id="panels">
          <!-- Search results panel (hidden by default) -->
          <div id="searchPanel" class="glass-panel" style="display:none">
            <div class="space-between" style="margin-bottom:12px">
              <h2 style="margin:0">Search Results</h2>
              <div class="row">
                <button id="clearSearch" class="back-btn">Clear</button>
              </div>
            </div>
            <div id="searchResultsList" style="display:grid;gap:10px"></div>
          </div>

          <!-- Departments / Teachers -->
          <div id="mainPanel">
            <!-- Departments -->
            <div id="departmentsPanel">
              <h2 style="text-align:center;margin-bottom:14px;color:var(--accent-1)">Departments</h2>

              <div id="departmentsGrid" class="grid" role="list">
                {% for i in dept %}
                <a href="{% url 'depart' i.id %}" role="listitem" aria-label="Open department {{ i.name }}">
                  <div class="card" tabindex="0">
                    <div class="card-icon" aria-hidden="true">
                      <i class="fas fa-university"></i>
                    </div>

                    <h3 class="name">{{ i.name }}</h3>
                    <div class="dept-title">{{ i.short_description|default:'' }}</div>
                  </div>
                </a>
                {% endfor %}
              </div>
            </div>

          </div>
        </div>
      </div>
    </section>

    {% include 'foot.html' %}
  </body>
</html>
